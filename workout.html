<html>
	<head>
		<title>Track a Workout</title>
		<link rel="stylesheet" href="css/workoutStyle.css">
        <link rel="stylesheet" href="css/sharedStyle.css">
        <!-- <link rel="stylesheet" href="css/dashboardStyle.css"> -->

	</head>
	<body>
		<header class="topBar">
            <div>
                <img src="images/activ8logo.png">
                <h1 class="appName">Activ8</h1>
            </div>
            <div class="rightButts">
                <a href="dashboard.html" class = "profileButt">
                    <img src="images/userIcon.png">
                </a>
                <!-- <a href="login.html" class="logoutButt">Logout</a> -->
                <button class="logoutButt" onclick="window.location.href='login.html'">Logout</button>
            </div>
        </header>
        <div class="workoutHeading">
            <h2>Track a Workout</h2>
        </div>
        <div class="searchBar">
            <img src="images/magnifyingGlass.png">
            <input
                type="text"
                id="searchInput"
                placeholder= "Search an exercise to add to workout"
            >
            <!-- <h2>Search an exercise to add to workout</h2> -->
        </div>
        <div id= "exerciseSearch" class="exerciseSearch">
        </div>

        <div class="resistanceFields">
            
            <!-- <input
                type="text"
                id="reps"
                placeholder="reps"
            > -->
        </div>
        <!-- <div class="setsLine"> -->
            <!-- <input
                type="text"
                id="reps"
                placeholder="reps"
            > -->

        <!-- </div> -->
        


        <!-- <div class="menuBtn">
            <img src="images/menuButt.png" >

        </div> -->
        <img class="menuBtn" src="images/menuButt.png" >
        <script id="exerciseData" type="application/json">
        {
            "exercises": [
            {"id": 1,"name": "squat", "type": "resistance training"},
            {"id": 2, "name": "dumbell squat", "type": "resistance training"},
            {"id": 3, "name": "pull up", "type": "resistance training"},
            {"id": 4, "name": "pushup", "type": "resistance training"},
            {"id": 5, "name": "run", "type": "cardiovsascular training"},
            {"id": 5, "name": "walk", "type": "cardiovsascular training"}
            ]
        }
        </script>
        <script>

  // Parse JSON embedded in the HTML
  const exerciseJSON = document.getElementById('exerciseData').textContent;
  const exercises = JSON.parse(exerciseJSON).exercises;

  const exerciseInput = document.getElementById('searchInput');
  const exerciseSearch = document.getElementById('exerciseSearch');
  const resistanceFields = document.querySelector('.resistanceFields');

  // Clear placeholder when user clicks on the box (focus)
  exerciseInput.addEventListener('focus', () => {
    exerciseInput.placeholder = '';
    // If thereâ€™s text already typed, re-show the box
    if (exerciseInput.value.trim() !== '' && exerciseSearch.innerHTML.trim() !== '') {
      exerciseSearch.style.display = 'block';
    }
  });

  // Restore placeholder when they click away and the box is empty (blur)
  exerciseInput.addEventListener('blur', () => {
    if (exerciseInput.value === '') {
      exerciseInput.placeholder = 'Search an exercise to add to workout';
    }
  });

  // Filter and show exercise matches as user types
  exerciseInput.addEventListener('input', () => {
    const query = exerciseInput.value.toLowerCase().trim();

    // If empty search bar, close results box
    if (query === '') {
      exerciseSearch.style.display = 'none';
      exerciseSearch.innerHTML = '';
      return;
    }

    const filtered = exercises.filter(ex => 
      ex.name.toLowerCase().includes(query)
    );

    displayResults(filtered);
  });

  // Display results dynamically
  function displayResults(results) {
    exerciseSearch.innerHTML = '';

    if (results.length === 0) {
      exerciseSearch.innerHTML = '<p class="noResults">No exercise matches your search</p>';
    } else {
      results.forEach(ex => {
        const div = document.createElement('div');
        div.classList.add('exerciseResult');
        div.textContent = `${ex.name} (${ex.type})`;

        // When user clicks on an exercise, collapse search
        div.addEventListener('click', () => {
          addExerciseBox(ex.name);
          exerciseInput.value = ''; // clear search bar
          exerciseSearch.innerHTML = ''; // hide results
          exerciseSearch.style.display = 'none';
        });

        exerciseSearch.appendChild(div);
      });
    }
    exerciseSearch.style.display = 'block';
  }

  //  Function to create exercise box under search
  function addExerciseBox(exerciseName) {
  const wrapper = document.createElement('div');
  wrapper.classList.add('exerciseWrapper'); // contains the box + reps label

  const div = document.createElement('div');
  div.classList.add('exerciseBox');
  div.setAttribute('data-name', exerciseName);

  for(i = 0; i< 3; i++){ //create set 1-3

  }
  const label = document.createElement('label');
  label.textContent = 'Set' ;
  label.classList.add('setsLabel');

  wrapper.appendChild(div);
  wrapper.appendChild(label);
  resistanceFields.appendChild(wrapper);
  }

  // Hide results when clicking outside
  document.addEventListener('click', (event) => {
    const isClickInside = exerciseInput.contains(event.target) || exerciseSearch.contains(event.target);
    if (!isClickInside) {
      exerciseSearch.style.display = 'none';
    }
  });
</script>


	</body>

</html>
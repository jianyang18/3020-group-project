<!DOCTYPE html>
<html>
  <head>
    <title>Community Page</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="./css/palette.css" />
    <link rel="stylesheet" href="./css/sharedStyle.css" />
    <link rel="stylesheet" href="./css/community.css" />
    <link rel="stylesheet" href="./css/indexStyle.css" />
  </head>
  <body>
    <!-- topBar -->
    <header class="topBar">
      <div>
        <img src="images/activ8logo.png" alt="Activ8 logo" />
        <h1 class="appName">Activ8</h1>
      </div>
      <div class="rightButts">
        <a href="dashboard.html" class="profileButt">
          <img src="images/userIcon.png" alt="Profile" />
        </a>
        <button class="logoutButt" onclick="window.location.href='login.html'">Logout</button>
      </div>
    </header>

    <div class="navBar">
			<a href="./dashboard.html" class="navbar-link">Dashboard</a>
			<a href="./mealTracking.html" class="navbar-link">Track a Meal</a>
			<a href="./workout.html" class="navbar-link">Track a Workout</a>
			<a href="./community.html" class="navbar-link selected">Community Page</a>
			<a href="./createPost.html" class="navbar-link">Create a Post</a>
		</div>

    <main class="communityMain">
      <h2 class="pageTitle">Community</h2>
      <div class="communityContent"></div>

      <!-- Feed -->
      <section id="feed" class="feed">
        <!-- Post 1 -->
        <article class="post">
          <img src="images/foodsample1.jpeg" />
          <div class="content">
            <h2>Dinner!!</h2>
            <div class="caption">
              <h3>Simple and Satisfying, Home cooked rice and Chicken tonight</h3>
            </div>
            <div class="actions">
              <button class="like">‚ù§Ô∏è 12</button>
              <button class="comment">üí¨ 3</button>
            </div>
          </div>
        </article>

        <article class="post">
          <img src="images/gympicture.jpeg" />
          <div class="content">
            <h2>Goals...</h2>
            <div class="caption">
              <h3>@joane, I am going to look like a dorito if it kills me</h3>
            </div>
            <div class="actions">
              <button class="like">‚ù§Ô∏è 56</button>
              <button class="comment">üí¨ 12</button>
            </div>
          </div>
        </article>
      </section>
    </main>

    <button class="fab" aria-label="Create new post">+</button>

    <nav class="feed-tabs" aria-label="Feed tabs">
        <button class="tab-btn" aria-pressed="true">All Posts</button>
        <button class="tab-btn" aria-pressed="false">My Posts</button>
    </nav>


    <!-- New Post Modal -->
<div id="newPostModal" class="modal" aria-hidden="true">
  <div class="modal__overlay"></div>

  <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="np-title">
    <header class="modal__header">
      <h3 id="np-title">New Post</h3>
      <button class="modal__close" aria-label="Close">√ó</button>
    </header>

    <div class="modal__body">
      <div class="modal__grid">
        <!-- Left: media preview + upload -->
        <div class="media-uploader">
          <div id="np-preview" class="preview" aria-label="Image preview"></div>

          <label class="upload-btn">
            <input id="np-file" type="file" accept="image/*,video/*" hidden />
            <span class="material-symbols-outlined" aria-hidden="true">add_a_photo</span>
            Add photo/video
          </label>
        </div>
        <div class="post-fields">

        <!-- Title -->
        <label for="np-title-input">Title</label>
        <input 
            id="np-title-input" 
            type="text" 
            placeholder="Enter a title‚Ä¶" 
        />

        <!-- Caption -->
        <label for="np-caption">Caption</label>
        <textarea 
            id="np-caption" 
            rows="6" 
            placeholder="Write your caption‚Ä¶">
        </textarea>

        </div>

    <footer class="modal__footer">
      <button id="np-submit" type="button" class="btn-primary">Post</button>
    </footer>
  </div>
</div>

<script>
  const modal = document.getElementById('newPostModal');
  const openBtn = document.querySelector('.fab');       // your existing +
  const closeBtn = modal.querySelector('.modal__close');
  const overlay  = modal.querySelector('.modal__overlay');
  const fileInput = document.getElementById('np-file');
  const preview = document.getElementById('np-preview');
  const submit = document.getElementById('np-submit');

  function openModal() {
    modal.classList.add('is-open');
    modal.setAttribute('aria-hidden','false');
  }
  function closeModal() {
    modal.classList.remove('is-open');
    modal.setAttribute('aria-hidden','true');
  }

  openBtn.addEventListener('click', openModal);
  closeBtn.addEventListener('click', closeModal);
  overlay.addEventListener('click', closeModal);
  document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape') closeModal(); });

  // Image/video preview
  fileInput.addEventListener('change', (e) => {
    const file = e.target.files && e.target.files[0];
    if (!file) return;
    const url = URL.createObjectURL(file);
    preview.style.backgroundImage = `url('${url}')`;
    preview.classList.add('has-media');
  });

  // Demo ‚ÄúPost‚Äù action just closes the modal
  submit.addEventListener('click', () => {
    // TODO: collect file + caption and add to feed if you want
    closeModal();
  });

  const feed = document.getElementById("feed");

submit.addEventListener("click", () => {
  const title = document.getElementById("np-title-input").value.trim();
  const caption = document.getElementById("np-caption").value.trim();
  const file = fileInput.files[0];

  // If no file or no title, don‚Äôt continue (prevent empty cards)
  if (!file || !title) {
    alert("Please include at least an image and title.");
    return;
  }

  // Create temp URL
  const imgURL = URL.createObjectURL(file);

  // Build new post
  const newPost = document.createElement("article");
  newPost.className = "post";

  newPost.innerHTML = `
    <img src="${imgURL}" />

    <div class="content">
      <h2>${title}</h2>

      <div class="caption">
        <h3>${caption}</h3>
      </div>

      <div class="actions">
        <button class="like">‚ù§Ô∏è 0</button>
        <button class="comment">üí¨ 0</button>
      </div>
    </div>
  `;

  // Add NEW post at the TOP
  feed.prepend(newPost);

  // Reset modal for next
  fileInput.value = "";
  document.getElementById("np-title-input").value = "";
  document.getElementById("np-caption").value = "";
  preview.style.backgroundImage = "";
  preview.classList.remove("has-media");

  closeModal();
});

 
</script>


  </body>
</html>
